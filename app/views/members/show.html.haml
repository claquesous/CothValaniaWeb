%p#notice= notice

%p
  %b Name:
  = @member.name
%p
  %b Join date:
  = @member.join_date
%p
  %b Points:
  = @member.points
%p
  %b Url:
  = @member.url
%p
  %b Remarks:
  = @member.remarks
%p
  %b Active:
  = @member.active
%p
  %b Admin:
  = @member.admin
%p
  %b Leader:
  = @member.leader
%p
  %b Reward cycle:
  = @member.reward_cycle
%p
  %b Cycle date:
  = @member.cycle_date

%table
  %tr
    %th Name
    %th Points
    %th Remarks
    %th Sex
    %th Race
    - @jobs.each do |j|
      %th= j.name
  - @member.characters.each do |c|
    %tr
      %td= c.name
      %td= c.points
      %td= c.remarks
      %td= c.sex
      %td= c.race.name unless c.race.nil?
      - @jobs.each do |j|
        %td= c.jobs.include?(j)

%p
  %b Event Attendance 
  %table
    - @member.event_attendances.each do |e|
      %tr
        %td= e.occurrence.end_time.strftime("%Y-%m-%d")
        %td= e.event.name
        %td (#{e.character.name} #{e.event.points})

%p
  %b Drops List
  %table
    - @member.character_rewards.order(:preference).each do |r|
      %tr
        %td #{r.preference}.
        %td= r.reward.name
        - if r.obtained
          %td Obtained (#{r.obtained_points})
        - else
          %td Points: #{@member.points.to_f/r.preference}

%p
  %b Drops Obtained
  %table
    - @member.character_rewards.order(:preference).each do |r|
      - if r.obtained
        %tr
          %td= r.reward.name
          %td= r.occurrence.end_time
          %td= r.obtained_points

= link_to 'Edit', edit_member_path(@member)
\|
= link_to 'Back', members_path
